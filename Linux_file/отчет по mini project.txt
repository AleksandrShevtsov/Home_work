### Post Mortem по выполненной работе

#### Причины инцидента

В ходе инцидента было установлено, что веб-сервис перестал работать по следующим причинам:

1. **Заполненное дисковое пространство**:
   - Дисковое пространство на сервере было полностью занято, что привело к остановке веб-сервиса и невозможности его нормального функционирования.
   - Основной причиной заполнения диска были большие лог-файлы, генерируемые веб-сервером.

2. **Неактивный процесс `httpd`**:
   - Веб-сервер `httpd` был неактивен, что также препятствовало доступу к веб-приложению.

3. **Необходимость восстановления конфигурационных файлов**:
   - Конфигурационный файл веб-приложения требовал восстановления из резервной копии.

#### Предпринятые шаги для восстановления сервиса и устранения проблемы

1. **Проверка статуса сервера**:
   - Подключение к серверу через SSH.
   - Проверка статуса процесса `httpd` командой `sudo service httpd status`.

2. **Запуск сервиса `httpd`**:
   - Попытка запуска веб-сервера командой `sudo service httpd start`.

3. **Анализ дискового пространства**:
   - Проверка использования дискового пространства командой `df -h`.
   - Обнаружение больших лог-файлов командой `find / -type f -size +150M`.

4. **Очистка лог-файлов**:
   - Очистка содержимого больших лог-файлов для освобождения места на диске командой `sudo echo "" > /var/log/httpd/access_log`.
   - Удаление архивов с лог файлами

5. **Восстановление конфигурационного файла**:
   - Найдена ошибка в конфигурационном файле
   - Удаление нерабочего и установка рабочего файла с помощью команды перемещения  
   - sudo rm /var/www/html/mediawiki/LocalSettings.php.
   - mv /var/www/html/mediawiki/LcalSettings.php /var/www/html/mediawiki/LocalSettings.php
   - определили что адрес не правильный. Изменение на правильный

6. **Настройка автоматической очистки лог-файлов**:
   - Создание скрипта для архивации и удаления старых лог-файлов.
   - #!/bin/bash

	LOG_DIR="/var/log/httpd"

	BACUK_DIR="/home/ec2-user/backup_log"

	mkdir -p "$BACUK_DIR"

	DATE= date +%Y%m%d

	ARHIVE="backup_log-$DATE.tar.gz"

	sudo tar -czf "$BACUK_DIR/$ARHIVE" "$LOG_DIR"

	sudo find "$BACUK_DIR" -type f -name "backup_log-*.tar.gz" -mtime +3 -exec.rm {}-\;

	sudo rm "$LOG_DIR/access_log"

	sudo service httpd restart

   - Добавление правильного задания в cron для автоматической очистки логов и удаление неправильного задания.
   - Стояла задача по архивации каждую минуту

#### Полученные результаты

- Веб-сервис был успешно восстановлен и запущен.
- Дисковое пространство было освобождено, что позволило веб-серверу продолжить нормальную работу.
- Конфигурационный файл был восстановлен, что обеспечило корректную работу веб-приложения.
- Настроено автоматическое задание для регулярной очистки лог-файлов, что предотвращает переполнение дискового пространства в будущем.

#### Рекомендации и предложения по улучшению процессов

1. **Мониторинг дискового пространства**:
   - Внедрить систему мониторинга, которая будет отслеживать использование дискового пространства и уведомлять администраторов при достижении определенного порога заполнения.

2. **Регулярная очистка лог-файлов**:
   - Настроить регулярные задания для архивации и удаления старых лог-файлов, чтобы предотвратить переполнение диска.

3. **Резервное копирование конфигурационных файлов**:
   - Регулярно создавать резервные копии важных конфигурационных файлов и сохранять их в надежном месте.

4. **Обучение персонала**:
   - Проводить регулярное обучение и инструктаж персонала по вопросам администрирования и мониторинга серверов, чтобы оперативно реагировать на возможные инциденты.

5. **Автоматизация задач**:
   - Внедрить больше автоматизированных скриптов и инструментов для выполнения рутинных задач, что снизит вероятность ошибок и ускорит процесс восстановления после инцидентов.

### Заключение

Анализ инцидента и предпринятые шаги по восстановлению веб-сервиса показали важность регулярного мониторинга и автоматизации задач администрирования. 
Внедрение предложенных рекомендаций поможет предотвратить подобные инциденты в будущем и обеспечит стабильную работу веб-сервиса.